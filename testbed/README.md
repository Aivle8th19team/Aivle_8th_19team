# ë‚©ê¸° ì˜ˆì¸¡ í…ŒìŠ¤íŠ¸ë² ë“œ (Delay Prediction Testbed)

## ê°œìš”
ê³µì • ì´ìƒì´ ëˆ„ì ë  ê²½ìš° ìµœì¢… ë‚©ê¸°ê°€ ì§€ì—°ë  í™•ë¥ ê³¼ ì˜ˆìƒ ì§€ì—° ì‹œê°„ì„ ì˜ˆì¸¡í•˜ëŠ” ë…ë¦½ì ì¸ í…ŒìŠ¤íŠ¸ í™˜ê²½ì…ë‹ˆë‹¤.

## ì£¼ìš” íŠ¹ì§•

### 1. ê³µì •ë³„ ì ìˆ˜í™” ì‹œìŠ¤í…œ
ê° ê³µì •ì˜ ì´ìƒ ì´ë²¤íŠ¸ë¥¼ ì ìˆ˜í™”í•˜ì—¬ ì§€ì—° ì˜í–¥ì„ ê³„ì‚°í•©ë‹ˆë‹¤.

#### ì´ë²¤íŠ¸ íƒ€ì…ë³„ ê¸°ë³¸ ì ìˆ˜
- **DEFECT (ê²°í•¨)**: 2ì‹œê°„
- **BREAKDOWN (ê³ ì¥)**: 8ì‹œê°„
- **LINE_HOLD (ë¼ì¸ì •ì§€)**: 4ì‹œê°„

#### ê³µì •ë³„ ê°€ì¤‘ì¹˜
```python
'Press': 1.0,
'Welding': 1.3,       # ìš©ì ‘ì€ ë³‘ëª© ê³µì •
'Paint': 1.2,         # ë„ì¥ë„ ì¤‘ìš”
'Body_Assembly': 1.1,
'Engine': 1.0,
'Windshield': 0.9
```

#### ìµœì¢… ì ìˆ˜ ê³„ì‚° ê³µì‹
```
ìµœì¢…_ì ìˆ˜ = ê¸°ë³¸_ì ìˆ˜ Ã— ê³µì •_ê°€ì¤‘ì¹˜ Ã— ì‹¬ê°ë„_ë°°ìˆ˜ Ã— ìˆ˜ëŸ‰_ê°€ì¤‘ì¹˜ Ã— ë¯¸í•´ê²°_ë°°ìˆ˜ Ã— ë¼ì¸ì •ì§€_ë°°ìˆ˜
```

**ë°°ìˆ˜ ìƒì„¸**:
- ì‹¬ê°ë„: 0(0.5ë°°), 1(1.0ë°°), 2(2.0ë°°), 3(4.0ë°°)
- ìˆ˜ëŸ‰: 1 + (ì˜í–¥ìˆ˜ëŸ‰ - 1) Ã— 0.2
- ë¯¸í•´ê²°: 1.5ë°° (í•´ê²°ë¨: 1.0ë°°)
- ë¼ì¸ì •ì§€: 2.0ë°° (ì¼ë°˜: 1.0ë°°)

### 2. 2ë‹¨ê³„ ì˜ˆì¸¡ ëª¨ë¸

#### Stage 1: ë¶„ë¥˜ (ì§€ì—° ì—¬ë¶€)
- **ëª¨ë¸**: XGBoost Classifier
- **ëª©í‘œ**: ë‚©ê¸° ì§€ì—° ë°œìƒ ì—¬ë¶€ ì˜ˆì¸¡
- **ì¶œë ¥**: ì§€ì—° í™•ë¥  (0.0 ~ 1.0)

#### Stage 2: íšŒê·€ (ì§€ì—° ì‹œê°„)
- **ëª¨ë¸**: XGBoost Regressor
- **ëª©í‘œ**: ì˜ˆìƒ ì§€ì—° ì‹œê°„ ì˜ˆì¸¡
- **ì¶œë ¥**: ì§€ì—° ì‹œê°„ (ì‹œê°„ ë‹¨ìœ„)

### 3. ìœ„í—˜ë„ ë¶„ë¥˜

| ìœ„í—˜ë„ | ì˜ˆìƒ ì§€ì—° ì‹œê°„ | ì¡°ì¹˜ |
|--------|---------------|------|
| LOW | < 4ì‹œê°„ | ëª¨ë‹ˆí„°ë§ |
| MEDIUM | 4~12ì‹œê°„ | ì‚¬ì „ ëŒ€ë¹„ |
| HIGH | 12~48ì‹œê°„ | ì¦‰ì‹œ ê°œì… |
| CRITICAL | â‰¥ 48ì‹œê°„ | ê³ ê° í†µë³´ |

## ì‚¬ìš© ë°©ë²•

### 1. í™˜ê²½ ì„¤ì •
```bash
# Python ê°€ìƒí™˜ê²½ í™œì„±í™”
conda activate chzm

# í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip install xgboost scikit-learn pandas numpy matplotlib seaborn
```

### 2. ì‹¤í–‰
```bash
cd testbed
python delay_prediction_testbed.py
```

### 3. ì¶œë ¥ íŒŒì¼
ì‹¤í–‰ í›„ ë‹¤ìŒ íŒŒì¼ë“¤ì´ ìƒì„±ë©ë‹ˆë‹¤:
- `orders_sample.csv`: 200ê°œ ìƒ˜í”Œ ì£¼ë¬¸ ë°ì´í„°
- `events_sample.csv`: ê³µì • ì´ë²¤íŠ¸ ë°ì´í„°
- `features.csv`: íŠ¹ì„± ì—”ì§€ë‹ˆì–´ë§ ê²°ê³¼ (ì•½ 30ê°œ íŠ¹ì„±)
- `delay_model.pkl`: í›ˆë ¨ëœ XGBoost ëª¨ë¸
- `delay_prediction_results.png`: ì‹œê°í™” ê²°ê³¼

## íŠ¹ì„± ì—”ì§€ë‹ˆì–´ë§

### ìƒì„±ë˜ëŠ” íŠ¹ì„± (ì•½ 30ê°œ)

#### 1. ê¸°ë³¸ íŠ¹ì„±
- `order_qty`: ì£¼ë¬¸ ìˆ˜ëŸ‰
- `planned_days`: ê³„íš ê¸°ê°„

#### 2. ì ìˆ˜ íŠ¹ì„±
- `total_score`: ì´ ì ìˆ˜ (ë³‘ëª© íš¨ê³¼ ë°˜ì˜)
- `press_score`, `welding_score`, `paint_score`, ...

#### 3. ì´ë²¤íŠ¸ í†µê³„
- `total_events`: ì´ ì´ë²¤íŠ¸ ìˆ˜
- `severity_sum`, `severity_max`, `severity_mean`: ì‹¬ê°ë„ í†µê³„
- `qty_affected_sum`: ì´ ì˜í–¥ ìˆ˜ëŸ‰
- `line_hold_count`: ë¼ì¸ì •ì§€ ê±´ìˆ˜
- `unresolved_count`: ë¯¸í•´ê²° ì´ë²¤íŠ¸ ìˆ˜

#### 4. ì´ë²¤íŠ¸ íƒ€ì…ë³„
- `defect_count`: ê²°í•¨ ê±´ìˆ˜
- `breakdown_count`: ê³ ì¥ ê±´ìˆ˜
- `line_hold_count`: ë¼ì¸ì •ì§€ ê±´ìˆ˜

#### 5. ê³µì •ë³„ ì´ë²¤íŠ¸ ìˆ˜
- `press_event_count`, `welding_event_count`, ...

## ì˜ˆì¸¡ ê²°ê³¼ ì˜ˆì‹œ

```python
ì£¼ë¬¸ #42
  ì§€ì—° í™•ë¥ : 78.5%
  ì˜ˆìƒ ì§€ì—°: 12.3 ì‹œê°„
  ì‹¤ì œ ì§€ì—°: 11.8 ì‹œê°„
  ìœ„í—˜ë„: HIGH
  ì˜ˆì¸¡ ì˜¤ì°¨: 0.5 ì‹œê°„
  ì´ ì ìˆ˜: 45.2

  ê³µì •ë³„ ì ìˆ˜:
    Welding: 24.5
    Paint: 12.3
    Body_Assembly: 8.4
```

## ì‹œê°í™” ê²°ê³¼

ìƒì„±ë˜ëŠ” ê·¸ë˜í”„ (4ê°œ):
1. **ì§€ì—° ë°œìƒ ë¶„í¬**: ì •ìƒ vs ì§€ì—° ì£¼ë¬¸ ë¹„ìœ¨
2. **ì§€ì—° ì‹œê°„ íˆìŠ¤í† ê·¸ë¨**: ì§€ì—°ëœ ì£¼ë¬¸ì˜ ì‹œê°„ ë¶„í¬
3. **ì ìˆ˜ vs ì‹¤ì œ ì§€ì—°**: ì´ ì ìˆ˜ì™€ ì‹¤ì œ ì§€ì—°ì˜ ìƒê´€ê´€ê³„
4. **ê³µì •ë³„ í‰ê·  ì ìˆ˜**: ì–´ë–¤ ê³µì •ì´ ê°€ì¥ ë§ì€ ë¬¸ì œë¥¼ ì¼ìœ¼í‚¤ëŠ”ì§€

## ëª¨ë¸ ì„±ëŠ¥ ëª©í‘œ

### ë¶„ë¥˜ (ì§€ì—° ì—¬ë¶€)
- ROC-AUC: > 0.80
- F1-Score: > 0.75
- Accuracy: > 0.80

### íšŒê·€ (ì§€ì—° ì‹œê°„)
- RMSE: < 5ì‹œê°„
- MAE: < 3ì‹œê°„
- RÂ²: > 0.70

## ì£¼ìš” í´ë˜ìŠ¤ ë° ë©”ì„œë“œ

### DelayPredictionTestbed

```python
class DelayPredictionTestbed:
    # ë°ì´í„° ìƒì„±
    def generate_sample_data(n_orders=200)
    
    # ì ìˆ˜ ê³„ì‚°
    def calculate_process_scores(order_id, events_df)
    
    # íŠ¹ì„± ì—”ì§€ë‹ˆì–´ë§
    def prepare_features(orders_df, events_df)
    
    # ëª¨ë¸ í›ˆë ¨
    def train_model(features_df, orders_df)
    
    # ì˜ˆì¸¡
    def predict(order_id, features_df, orders_df, events_df)
    
    # ì‹œê°í™”
    def visualize_results(features_df, orders_df)
    
    # ì €ì¥/ë¡œë“œ
    def save_model(filepath)
    def load_model(filepath)
```

## ì‹¤ì „ í™œìš© ì˜ˆì‹œ

### 1. ëª¨ë¸ ì¬ì‚¬ìš©
```python
from delay_prediction_testbed import DelayPredictionTestbed

# ëª¨ë¸ ë¡œë“œ
testbed = DelayPredictionTestbed()
testbed.load_model('delay_model.pkl')

# ìƒˆë¡œìš´ ì£¼ë¬¸ ì˜ˆì¸¡
result = testbed.predict(order_id=123, features_df, orders_df, events_df)
print(f"ì§€ì—° í™•ë¥ : {result['delay_probability']*100:.1f}%")
print(f"ì˜ˆìƒ ì§€ì—°: {result['expected_delay_hours']:.1f}ì‹œê°„")
```

### 2. ì‹¤ì‹œê°„ ì ìˆ˜ ê³„ì‚°
```python
# íŠ¹ì • ì£¼ë¬¸ì˜ í˜„ì¬ ì ìˆ˜ í™•ì¸
score_result = testbed.calculate_process_scores(order_id=123, events_df)
print(f"ì´ ì ìˆ˜: {score_result['total_score']}")
print(f"ê³µì •ë³„ ì ìˆ˜: {score_result['process_scores']}")
```

### 3. ë°°ì¹˜ ì˜ˆì¸¡
```python
# ì—¬ëŸ¬ ì£¼ë¬¸ ì¼ê´„ ì˜ˆì¸¡
results = []
for order_id in [1, 2, 3, 4, 5]:
    result = testbed.predict(order_id, features_df, orders_df, events_df)
    results.append(result)

# ìœ„í—˜ë„ ë†’ì€ ìˆœìœ¼ë¡œ ì •ë ¬
sorted_results = sorted(results, 
                       key=lambda x: x['expected_delay_hours'], 
                       reverse=True)
```

## ë³‘ëª© íš¨ê³¼ ë°˜ì˜

ì—¬ëŸ¬ ê³µì •ì—ì„œ ë™ì‹œì— ë¬¸ì œê°€ ë°œìƒí•´ë„, ì‹¤ì œ ì§€ì—°ì€ ê°€ì¥ ì‹¬ê°í•œ ê³µì •ì— ì˜í•´ ê²°ì •ë©ë‹ˆë‹¤.

**ê³„ì‚° ë°©ì‹**:
```python
# ê³µì •ë³„ ì ìˆ˜ë¥¼ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
sorted_scores = [45.2, 23.1, 12.5, 8.3, 2.1, 0.0]

# ë³‘ëª© íš¨ê³¼ ì ìš© (ì²« ë²ˆì§¸ëŠ” 100%, ë‘ ë²ˆì§¸ëŠ” 30%, ì„¸ ë²ˆì§¸ëŠ” 10%...)
total = 45.2Ã—1.0 + 23.1Ã—0.3 + 12.5Ã—0.09 + 8.3Ã—0.027 + ...
```

ì´ë ‡ê²Œ í•˜ë©´ **ê°€ì¥ ì‹¬ê°í•œ ë³‘ëª© ê³µì •ì´ ì´ ì ìˆ˜ë¥¼ ì£¼ë„**í•˜ê²Œ ë©ë‹ˆë‹¤.

## ì¥ì 

### 1. ë…ë¦½ì„±
- ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • ì—†ìŒ
- Git ì¶©ëŒ ì—†ìŒ
- ê²©ë¦¬ëœ í…ŒìŠ¤íŠ¸ í™˜ê²½

### 2. ì™„ì „í•œ íŒŒì´í”„ë¼ì¸
- ë°ì´í„° ìƒì„± â†’ íŠ¹ì„± ê³µí•™ â†’ í›ˆë ¨ â†’ ì˜ˆì¸¡ â†’ ì‹œê°í™”

### 3. ì‹¤ìš©ì„±
- ì‹¤ì œ ë°ì´í„° êµ¬ì¡°ì™€ ìœ ì‚¬í•œ ìƒ˜í”Œ ìƒì„±
- ê³µì •ë³„ ì ìˆ˜í™” ë¡œì§ ê²€ì¦
- ëª¨ë¸ ì„±ëŠ¥ í‰ê°€

### 4. í™•ì¥ì„±
- ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™ ì‰½ê²Œ ì „í™˜ ê°€ëŠ¥
- Backend API í†µí•© ì¤€ë¹„ ì™„ë£Œ

## ë‹¤ìŒ ë‹¨ê³„

1. **í…ŒìŠ¤íŠ¸ë² ë“œ ì‹¤í–‰** â†’ ìƒ˜í”Œ ë°ì´í„°ë¡œ ê²€ì¦
2. **ì ìˆ˜í™” ë¡œì§ ì¡°ì •** â†’ ê°€ì¤‘ì¹˜ íŠœë‹
3. **ì‹¤ì œ DB ì—°ë™** â†’ PostgreSQL ë°ì´í„° ì‚¬ìš©
4. **Backend í†µí•©** â†’ Spring Boot APIì™€ ì—°ê²°
5. **Frontend ëŒ€ì‹œë³´ë“œ** â†’ React ì‹œê°í™”

## íŒŒì¼ êµ¬ì¡°

```
testbed/
â”œâ”€â”€ delay_prediction_testbed.py  # ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ README.md                     # ì´ ë¬¸ì„œ
â”œâ”€â”€ orders_sample.csv             # ìƒì„±ëœ ì£¼ë¬¸ ë°ì´í„°
â”œâ”€â”€ events_sample.csv             # ìƒì„±ëœ ì´ë²¤íŠ¸ ë°ì´í„°
â”œâ”€â”€ features.csv                  # íŠ¹ì„± ë°ì´í„°
â”œâ”€â”€ delay_model.pkl               # í›ˆë ¨ëœ ëª¨ë¸
â””â”€â”€ delay_prediction_results.png  # ì‹œê°í™” ê²°ê³¼
```

## ë¬¸ì˜ ë° í”¼ë“œë°±

í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ í™•ì¸í•˜ê³  ë‹¤ìŒì„ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- ê³µì •ë³„ ê°€ì¤‘ì¹˜
- ì´ë²¤íŠ¸ íƒ€ì…ë³„ ê¸°ë³¸ ì ìˆ˜
- ì‹¬ê°ë„ ë°°ìˆ˜
- ë³‘ëª© íš¨ê³¼ ê³„ìˆ˜

---

**ì‘ì„±ì¼**: 2026-01-30  
**ë²„ì „**: v1.0.0  
**ìƒíƒœ**: ğŸŸ¢ í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ì™„ë£Œ
