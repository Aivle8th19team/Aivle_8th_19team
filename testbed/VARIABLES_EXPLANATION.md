# ë‚©ê¸° ì˜ˆì¸¡ ëª¨ë¸ - ë³€ìˆ˜ êµ¬ì¡° ì„¤ëª…

## ğŸ“Š ëª¨ë¸ë§ ë³€ìˆ˜ êµ¬ì¡°

### ğŸ¯ ì¢…ì†ë³€ìˆ˜ (Target Variables, Y)

ìš°ë¦¬ ëª¨ë¸ì€ **2ë‹¨ê³„ ì˜ˆì¸¡**ì„ ìˆ˜í–‰í•˜ë¯€ë¡œ **2ê°œì˜ ì¢…ì†ë³€ìˆ˜**ê°€ ìˆìŠµë‹ˆë‹¤:

#### 1ï¸âƒ£ Stage 1: ë¶„ë¥˜ (Classification)
```python
y_class = (actual_delay_hours > 0).astype(int)
```

| ê°’ | ì˜ë¯¸ | ì„¤ëª… |
|---|------|------|
| **0** | ì •ìƒ | ë‚©ê¸° ë‚´ ì™„ë£Œ (ì§€ì—° ì—†ìŒ) |
| **1** | ì§€ì—° | ë‚©ê¸° ì´ˆê³¼ (ì§€ì—° ë°œìƒ) |

**ì˜ˆì‹œ**:
- ì£¼ë¬¸ #1: ë‚©ê¸°ì¼ë³´ë‹¤ 2ì‹œê°„ ì¼ì° ì™„ë£Œ â†’ `y_class = 0`
- ì£¼ë¬¸ #2: ë‚©ê¸°ì¼ë³´ë‹¤ 5ì‹œê°„ ëŠ¦ê²Œ ì™„ë£Œ â†’ `y_class = 1`

#### 2ï¸âƒ£ Stage 2: íšŒê·€ (Regression)
```python
y_reg = actual_delay_hours.clip(lower=0)
```

| ê°’ | ì˜ë¯¸ | ë‹¨ìœ„ |
|---|------|------|
| **0.0** | ì§€ì—° ì—†ìŒ | ì‹œê°„ |
| **> 0** | ì§€ì—° ì‹œê°„ | ì‹œê°„ (ì†Œìˆ˜ì  ê°€ëŠ¥) |

**ì˜ˆì‹œ**:
- ì£¼ë¬¸ #1: ì •ìƒ ì™„ë£Œ â†’ `y_reg = 0.0`
- ì£¼ë¬¸ #2: 5.3ì‹œê°„ ì§€ì—° â†’ `y_reg = 5.3`
- ì£¼ë¬¸ #3: 48ì‹œê°„ ì§€ì—° â†’ `y_reg = 48.0`

**ê³„ì‚° ë°©ì‹**:
```python
actual_delay_hours = (actual_completion_date - due_date).total_seconds() / 3600
# ìŒìˆ˜ëŠ” 0ìœ¼ë¡œ (ì¼ì° ì™„ë£Œí•œ ê²½ìš°)
y_reg = max(0, actual_delay_hours)
```

---

### ğŸ“ˆ ë…ë¦½ë³€ìˆ˜ (Independent Variables, X)

ëª¨ë¸ ì…ë ¥ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” **ì•½ 18~30ê°œì˜ íŠ¹ì„±**:

#### 1. ê¸°ë³¸ íŠ¹ì„± (2ê°œ)
| ë³€ìˆ˜ëª… | ì„¤ëª… | ì˜ˆì‹œ ê°’ |
|--------|------|---------|
| `order_qty` | ì£¼ë¬¸ ìˆ˜ëŸ‰ | 1, 2, 5, 10 |
| `planned_days` | ê³„íš ê¸°ê°„ (ì¼) | 10, 15, 20 |

#### 2. ì ìˆ˜ íŠ¹ì„± (7ê°œ)
| ë³€ìˆ˜ëª… | ì„¤ëª… | ê³„ì‚° ë°©ì‹ |
|--------|------|----------|
| `total_score` | ì´ ì ìˆ˜ (ë³‘ëª© íš¨ê³¼ ë°˜ì˜) | âˆ‘(ê³µì •ì ìˆ˜ Ã— 0.3^i) |
| `press_score` | Press ê³µì • ì ìˆ˜ | ì´ë²¤íŠ¸ ì ìˆ˜ í•©ê³„ |
| `welding_score` | Welding ê³µì • ì ìˆ˜ | ì´ë²¤íŠ¸ ì ìˆ˜ í•©ê³„ |
| `paint_score` | Paint ê³µì • ì ìˆ˜ | ì´ë²¤íŠ¸ ì ìˆ˜ í•©ê³„ |
| `body_assembly_score` | Body Assembly ì ìˆ˜ | ì´ë²¤íŠ¸ ì ìˆ˜ í•©ê³„ |
| `engine_score` | Engine ê³µì • ì ìˆ˜ | ì´ë²¤íŠ¸ ì ìˆ˜ í•©ê³„ |
| `windshield_score` | Windshield ê³µì • ì ìˆ˜ | ì´ë²¤íŠ¸ ì ìˆ˜ í•©ê³„ |

**ì ìˆ˜ ê³„ì‚° ê³µì‹**:
```
ì ìˆ˜ = ê¸°ë³¸ì ìˆ˜ Ã— ê³µì •ê°€ì¤‘ì¹˜ Ã— ì‹¬ê°ë„ë°°ìˆ˜ Ã— ìˆ˜ëŸ‰ê°€ì¤‘ì¹˜ Ã— ë¯¸í•´ê²°ë°°ìˆ˜ Ã— ë¼ì¸ì •ì§€ë°°ìˆ˜
```

#### 3. ì´ë²¤íŠ¸ í†µê³„ (7ê°œ)
| ë³€ìˆ˜ëª… | ì„¤ëª… | ì˜ˆì‹œ ê°’ |
|--------|------|---------|
| `total_events` | ì´ ì´ë²¤íŠ¸ ìˆ˜ | 0, 3, 7 |
| `severity_sum` | ì‹¬ê°ë„ í•©ê³„ | 0~999 |
| `severity_max` | ìµœëŒ€ ì‹¬ê°ë„ | 0, 1, 2, 3 |
| `severity_mean` | í‰ê·  ì‹¬ê°ë„ | 0.0~3.0 |
| `qty_affected_sum` | ì˜í–¥ë°›ì€ ì´ ìˆ˜ëŸ‰ | 0~999 |
| `line_hold_count` | ë¼ì¸ì •ì§€ ë°œìƒ íšŸìˆ˜ | 0, 1, 2 |
| `unresolved_count` | ë¯¸í•´ê²° ì´ë²¤íŠ¸ ìˆ˜ | 0, 1, 3 |

#### 4. ì´ë²¤íŠ¸ íƒ€ì…ë³„ ê°œìˆ˜ (3ê°œ)
| ë³€ìˆ˜ëª… | ì„¤ëª… |
|--------|------|
| `defect_count` | ê²°í•¨(DEFECT) ë°œìƒ íšŸìˆ˜ |
| `breakdown_count` | ê³ ì¥(BREAKDOWN) ë°œìƒ íšŸìˆ˜ |
| `line_hold_count` | ë¼ì¸ì •ì§€(LINE_HOLD) ë°œìƒ íšŸìˆ˜ |

#### 5. ê³µì •ë³„ ì´ë²¤íŠ¸ ìˆ˜ (6ê°œ) - ì„ íƒì 
| ë³€ìˆ˜ëª… | ì„¤ëª… |
|--------|------|
| `press_event_count` | Press ê³µì • ì´ë²¤íŠ¸ ìˆ˜ |
| `welding_event_count` | Welding ê³µì • ì´ë²¤íŠ¸ ìˆ˜ |
| `paint_event_count` | Paint ê³µì • ì´ë²¤íŠ¸ ìˆ˜ |
| `body_assembly_event_count` | Body Assembly ì´ë²¤íŠ¸ ìˆ˜ |
| `engine_event_count` | Engine ê³µì • ì´ë²¤íŠ¸ ìˆ˜ |
| `windshield_event_count` | Windshield ì´ë²¤íŠ¸ ìˆ˜ |

---

## ğŸ”„ ë°ì´í„° íë¦„

```
[ì‹¤ì œ ë°ì´í„°]
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì£¼ë¬¸ (orders)                       â”‚
â”‚ - order_id, order_date, due_date    â”‚
â”‚ - actual_completion_date            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì´ë²¤íŠ¸ (process_event)              â”‚
â”‚ - event_type, severity              â”‚
â”‚ - qty_affected, is_line_hold        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ íŠ¹ì„± ì—”ì§€ë‹ˆì–´ë§                     â”‚
â”‚ - ì ìˆ˜ ê³„ì‚° (ê³µì •ë³„)                â”‚
â”‚ - í†µê³„ ì§‘ê³„                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë…ë¦½ë³€ìˆ˜ (X)                        â”‚
â”‚ - 18~30ê°œ íŠ¹ì„±                      â”‚
â”‚ - ì˜ˆ: total_score, order_qty, ...  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì¢…ì†ë³€ìˆ˜ 1       â”‚ ì¢…ì†ë³€ìˆ˜ 2       â”‚
â”‚ y_class          â”‚ y_reg            â”‚
â”‚ (ì§€ì—° ì—¬ë¶€)      â”‚ (ì§€ì—° ì‹œê°„)      â”‚
â”‚ 0 ë˜ëŠ” 1         â”‚ 0.0 ì´ìƒ ì‹¤ìˆ˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ëª¨ë¸ 1           â”‚ ëª¨ë¸ 2           â”‚
â”‚ XGBoost          â”‚ XGBoost          â”‚
â”‚ Classifier       â”‚ Regressor        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì˜ˆì¸¡ ê²°ê³¼                           â”‚
â”‚ - delay_probability (í™•ë¥ )          â”‚
â”‚ - expected_delay_hours (ì‹œê°„)       â”‚
â”‚ - risk_level (ìœ„í—˜ë„)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ ì‹¤ì œ ë°ì´í„° ì˜ˆì‹œ

### ì…ë ¥ (X) - í•œ ì£¼ë¬¸ì˜ íŠ¹ì„±
```python
{
    'order_qty': 5,
    'planned_days': 15,
    'total_score': 42.3,
    'welding_score': 28.5,
    'paint_score': 13.8,
    'total_events': 4,
    'severity_sum': 7,
    'severity_max': 3,
    'unresolved_count': 1,
    'defect_count': 3,
    'breakdown_count': 1,
    ...
}
```

### ì¶œë ¥ (Y) - ì‹¤ì œê°’ (í›ˆë ¨ìš©)
```python
y_class = 1          # ì§€ì—° ë°œìƒ
y_reg = 8.5          # 8.5ì‹œê°„ ì§€ì—°
```

### ì˜ˆì¸¡ ê²°ê³¼
```python
{
    'delay_probability': 0.785,      # 78.5% í™•ë¥ ë¡œ ì§€ì—°
    'expected_delay_hours': 9.2,     # ì˜ˆìƒ 9.2ì‹œê°„ ì§€ì—°
    'risk_level': 'HIGH'             # ë†’ì€ ìœ„í—˜
}
```

---

## ğŸ¯ ëª¨ë¸ í•™ìŠµ ê³¼ì •

### 1ë‹¨ê³„: ë°ì´í„° ì¤€ë¹„
```python
# ì™„ë£Œëœ ì£¼ë¬¸ë§Œ í•„í„°ë§
completed_orders = orders_df[orders_df['order_status'] == 'COMPLETED']

# ë…ë¦½ë³€ìˆ˜ (X)
X = features_df.loc[completed_orders['order_id']]
# shape: (n_orders, n_features)
# ì˜ˆ: (200, 18)

# ì¢…ì†ë³€ìˆ˜ (Y)
y_class = (completed_orders['actual_delay_hours'] > 0).astype(int)
y_reg = completed_orders['actual_delay_hours'].clip(lower=0)
# shape: (n_orders,)
# ì˜ˆ: (200,)
```

### 2ë‹¨ê³„: í•™ìŠµ/í…ŒìŠ¤íŠ¸ ë¶„í• 
```python
X_train, X_test, y_class_train, y_class_test, y_reg_train, y_reg_test = \
    train_test_split(X, y_class, y_reg, test_size=0.2, random_state=42)

# X_train: (160, 18) - í•™ìŠµìš© íŠ¹ì„±
# y_class_train: (160,) - í•™ìŠµìš© ì§€ì—° ì—¬ë¶€
# y_reg_train: (160,) - í•™ìŠµìš© ì§€ì—° ì‹œê°„
```

### 3ë‹¨ê³„: ëª¨ë¸ í›ˆë ¨

#### Stage 1: ë¶„ë¥˜ ëª¨ë¸
```python
classifier = XGBClassifier()
classifier.fit(X_train, y_class_train)
# ì…ë ¥: X_train (íŠ¹ì„±)
# ì¶œë ¥: y_class_train (ì§€ì—° ì—¬ë¶€ 0/1)
```

#### Stage 2: íšŒê·€ ëª¨ë¸
```python
regressor = XGBRegressor()
regressor.fit(X_train, y_reg_train)
# ì…ë ¥: X_train (íŠ¹ì„±)
# ì¶œë ¥: y_reg_train (ì§€ì—° ì‹œê°„)
```

### 4ë‹¨ê³„: ì˜ˆì¸¡
```python
# ìƒˆë¡œìš´ ì£¼ë¬¸ì˜ íŠ¹ì„±
X_new = features_df.loc[[order_id]]

# ì˜ˆì¸¡
delay_probability = classifier.predict_proba(X_new)[0, 1]  # 0.785
expected_delay_hours = regressor.predict(X_new)[0]         # 9.2
```

---

## ğŸ“Š ë³€ìˆ˜ ê°„ ê´€ê³„

### ê°•í•œ ì–‘ì˜ ìƒê´€ê´€ê³„ (ì˜ˆìƒ)
- `total_score` â†‘ â†’ `y_reg` â†‘ (ì ìˆ˜ ë†’ì„ìˆ˜ë¡ ì§€ì—° ì‹œê°„ ì¦ê°€)
- `unresolved_count` â†‘ â†’ `y_class` â†‘ (ë¯¸í•´ê²° ë§ì„ìˆ˜ë¡ ì§€ì—° í™•ë¥  ì¦ê°€)
- `severity_max` â†‘ â†’ `y_reg` â†‘ (ì‹¬ê°ë„ ë†’ì„ìˆ˜ë¡ ì§€ì—° ì‹œê°„ ì¦ê°€)

### ì•½í•œ ìƒê´€ê´€ê³„
- `order_qty` â†‘ â†’ `y_reg` â†‘? (ìˆ˜ëŸ‰ ë§ì„ìˆ˜ë¡ ì§€ì—° ê°€ëŠ¥ì„±)
- `planned_days` â†‘ â†’ `y_reg` â†“? (ê¸°ê°„ ê¸¸ìˆ˜ë¡ ì—¬ìœ  ìˆìŒ)

---

## ğŸ” íŠ¹ì„± ì¤‘ìš”ë„ í™•ì¸ ë°©ë²•

ëª¨ë¸ í›ˆë ¨ í›„ ì–´ë–¤ ë³€ìˆ˜ê°€ ê°€ì¥ ì¤‘ìš”í•œì§€ í™•ì¸:

```python
# íŠ¹ì„± ì¤‘ìš”ë„
importance = classifier.feature_importances_
feature_importance = pd.DataFrame({
    'feature': feature_names,
    'importance': importance
}).sort_values('importance', ascending=False)

print(feature_importance.head(10))
```

**ì˜ˆìƒ ìƒìœ„ íŠ¹ì„±**:
1. `total_score` - ì´ ì ìˆ˜ê°€ ê°€ì¥ ì˜í–¥ë ¥ í´ ê²ƒ
2. `unresolved_count` - ë¯¸í•´ê²° ì´ë²¤íŠ¸
3. `severity_max` - ìµœëŒ€ ì‹¬ê°ë„
4. `welding_score` - ë³‘ëª© ê³µì • ì ìˆ˜
5. `total_events` - ì´ ì´ë²¤íŠ¸ ìˆ˜

---

## ğŸ“ ìš”ì•½

| êµ¬ë¶„ | ë³€ìˆ˜ | ê°œìˆ˜ | ì„¤ëª… |
|------|------|------|------|
| **ë…ë¦½ë³€ìˆ˜ (X)** | íŠ¹ì„± (Features) | 18~30ê°œ | ì£¼ë¬¸ ì •ë³´ + ì´ë²¤íŠ¸ ì ìˆ˜ + í†µê³„ |
| **ì¢…ì†ë³€ìˆ˜ 1 (Yâ‚)** | ì§€ì—° ì—¬ë¶€ (y_class) | 1ê°œ | 0(ì •ìƒ) ë˜ëŠ” 1(ì§€ì—°) |
| **ì¢…ì†ë³€ìˆ˜ 2 (Yâ‚‚)** | ì§€ì—° ì‹œê°„ (y_reg) | 1ê°œ | 0.0 ì´ìƒ ì‹¤ìˆ˜ (ì‹œê°„) |

**ëª¨ë¸ êµ¬ì¡°**:
```
X (18~30ê°œ íŠ¹ì„±) â†’ [XGBoost Classifier] â†’ Yâ‚ (ì§€ì—° í™•ë¥ )
X (18~30ê°œ íŠ¹ì„±) â†’ [XGBoost Regressor]  â†’ Yâ‚‚ (ì§€ì—° ì‹œê°„)
```

**í•µì‹¬**:
- âœ… ë…ë¦½ë³€ìˆ˜: ì£¼ë¬¸ê³¼ ì´ë²¤íŠ¸ì—ì„œ ì¶”ì¶œí•œ íŠ¹ì„±ë“¤
- âœ… ì¢…ì†ë³€ìˆ˜: ì‹¤ì œ ì§€ì—° ì—¬ë¶€ì™€ ì§€ì—° ì‹œê°„
- âœ… 2ë‹¨ê³„ ëª¨ë¸ë¡œ í™•ë¥ ê³¼ ì‹œê°„ì„ ë™ì‹œ ì˜ˆì¸¡

---

**ì‘ì„±ì¼**: 2026-01-30  
**ì°¸ê³  íŒŒì¼**: `real_data_testbed.py`, `delay_prediction_testbed.py`
